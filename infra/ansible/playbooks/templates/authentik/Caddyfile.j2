{{ domain_name }} {
	# -- WebFinger endpoint ---------------------------
	handle_path /.well-known/webfinger {
		header Content-Type "application/jrd+json"
		respond `{
		  "links": [{
		    "href": "https://{{ domain_name }}/application/o/authentik.company/",
		    "rel": "http://openid.net/specs/connect/1.0/issuer"
		  }],
		  "subject": "acct:akadmin@{{ domain_name }}"
		}` 200
	}

	# -- Reverse proxy to Authentik -------------------
	reverse_proxy https://server:9443 {
		transport http {
			versions 1.1              # HTTP/1.1 to allow WebSocket upgrades  
			tls_insecure_skip_verify  # keep only if you really canâ€™t validate the backend cert
		}
		# preserve original client details
		header_up Host              {host}
		header_up X-Real-IP         {remote_host}  # remote host placeholder 
		header_up X-Forwarded-Port  {server_port}
	}

	# Optional compression and hardening headers
	encode zstd gzip
	header {
		Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
		X-Content-Type-Options    "nosniff"
	}

	# Access log
	log {
		output stdout
		format console
		level DEBUG
	}
}
